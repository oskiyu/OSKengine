\hypertarget{_model_component3_d_8cpp_source}{}\doxysection{Model\+Component3\+D.\+cpp}
\label{_model_component3_d_8cpp_source}\index{OSKengine2/ModelComponent3D.cpp@{OSKengine2/ModelComponent3D.cpp}}
\mbox{\hyperlink{_model_component3_d_8cpp}{Ir a la documentaciÃ³n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_model_component3_d_8h}{ModelComponent3D.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_material_instance_8h}{MaterialInstance.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_model3_d_8h}{Model3D.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00005}00005 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_mesh3_d_8h}{Mesh3D.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_material_8h}{Material.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_i_material_slot_8h}{IMaterialSlot.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00009}00009 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k}{OSK}};}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00010}00010 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k_1_1_e_c_s}{OSK::ECS}};}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00011}00011 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k_1_1_a_s_s_e_t_s}{OSK::ASSETS}};}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00012}00012 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s}{OSK::GRAPHICS}};}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00014}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_acbf0c3707f4a8e4ad359abba9d4f9758}{00014}} ModelComponent3D::\string~ModelComponent3D() \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00015}00015     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i : meshesMaterialInstances)}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00016}00016         \textcolor{keyword}{delete} i.GetPointer();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00017}00017 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00019}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_af7f59fbb8292ffa10abf7effb21f10c8}{00019}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_af7f59fbb8292ffa10abf7effb21f10c8}{ModelComponent3D::SetModel}}(\mbox{\hyperlink{class_o_s_k_1_1_a_s_s_e_t_s_1_1_model3_d}{Model3D}}* model) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00020}00020     this-\/>model = model;}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00022}00022     \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} prevSize = meshesMaterialInstances.GetSize();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00023}00023     meshesMaterialInstances.Resize(model-\/>\mbox{\hyperlink{class_o_s_k_1_1_a_s_s_e_t_s_1_1_model3_d_a480cf3e35730e8fb88c1e40cef76fdea}{GetMeshes}}().GetSize(), \textcolor{keyword}{nullptr});}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00025}00025     \textcolor{keywordflow}{if} (material != \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00026}00026         \textcolor{keywordflow}{for} (\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} i = prevSize; i < meshesMaterialInstances.GetSize(); i++) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00027}00027             meshesMaterialInstances.At(i) = material-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material_acf1dacea3b45a53ca86d96e30af22af1}{CreateInstance}}();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00029}00029             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& t : texturesBound)}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00030}00030                 meshesMaterialInstances.At(i)-\/>GetSlot(t.first.first)-\/>SetTexture(t.first.second, t.second);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00032}00032             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& t : imagesBound)}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00033}00033                 meshesMaterialInstances.At(i)-\/>GetSlot(t.first.first)-\/>SetGpuImage(t.first.second, t.second);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00035}00035             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& t : uniformBuffersBound)}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00036}00036                 meshesMaterialInstances.At(i)-\/>GetSlot(t.first.first)-\/>SetUniformBuffer(t.first.second, t.second);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00037}00037         \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00038}00038     \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00039}00039 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00041}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_a2f5401ab89d8d6695004b86d0c4fbeff}{00041}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_a2f5401ab89d8d6695004b86d0c4fbeff}{ModelComponent3D::SetMaterial}}(\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material}{Material}}* material) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00042}00042     this-\/>material = material;}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00043}00043 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00044}00044     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& i : meshesMaterialInstances) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00045}00045         \textcolor{keywordflow}{if} (i.GetPointer() == \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00046}00046             i = material-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material_acf1dacea3b45a53ca86d96e30af22af1}{CreateInstance}}();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00048}00048             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& t : texturesBound)}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00049}00049                 i-\/>GetSlot(t.first.first)-\/>SetTexture(t.first.second, t.second);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00051}00051             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& t : imagesBound)}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00052}00052                 i-\/>GetSlot(t.first.first)-\/>SetGpuImage(t.first.second, t.second);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00054}00054             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& t : uniformBuffersBound)}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00055}00055                 i-\/>GetSlot(t.first.first)-\/>SetUniformBuffer(t.first.second, t.second);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00056}00056         \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00057}00057     \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00058}00058 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00060}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_afba134f6e97739aaf47a74c3b4ba6690}{00060}} \mbox{\hyperlink{class_o_s_k_1_1_a_s_s_e_t_s_1_1_model3_d}{Model3D}}* \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_afba134f6e97739aaf47a74c3b4ba6690}{ModelComponent3D::GetModel}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00061}00061     \textcolor{keywordflow}{return} model;}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00062}00062 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00064}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_a8cd49bb33367394b13c6b5e3ecf07b5e}{00064}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material}{Material}}* \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_a8cd49bb33367394b13c6b5e3ecf07b5e}{ModelComponent3D::GetMaterial}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00065}00065     \textcolor{keywordflow}{return} material;}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00066}00066 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00068}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_ad9162b7e1cb7978be75adda96e17ab79}{00068}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material_instance}{MaterialInstance}}* \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_ad9162b7e1cb7978be75adda96e17ab79}{ModelComponent3D::GetMeshMaterialInstance}}(\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} meshId)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00069}00069     \textcolor{keywordflow}{return} meshesMaterialInstances.At(meshId).GetPointer();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00070}00070 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00072}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_a39b08772aa749621a912984e310e0301}{00072}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_a39b08772aa749621a912984e310e0301}{ModelComponent3D::BindTextureForAllMeshes}}(\textcolor{keyword}{const} std::string\& slot, \textcolor{keyword}{const} std::string\& binding, \textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_a_s_s_e_t_s_1_1_texture}{ASSETS::Texture}}* texture) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00073}00073     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i : meshesMaterialInstances) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00074}00074         i-\/>GetSlot(slot)-\/>SetTexture(binding, texture);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00075}00075         i-\/>GetSlot(slot)-\/>FlushUpdate();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00076}00076     \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00078}00078     texturesBound.Insert(\{ slot, binding \}, texture);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00079}00079 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00081}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_aceb61878442196ac8c64cb657bd5bdbd}{00081}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_aceb61878442196ac8c64cb657bd5bdbd}{ModelComponent3D::BindGpuImageForAllMeshes}}(\textcolor{keyword}{const} std::string\& slot, \textcolor{keyword}{const} std::string\& binding, \textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_image}{GRAPHICS::GpuImage}}* image) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00082}00082     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i : meshesMaterialInstances) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00083}00083         i-\/>GetSlot(slot)-\/>SetGpuImage(binding, image);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00084}00084         i-\/>GetSlot(slot)-\/>FlushUpdate();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00085}00085     \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00087}00087     imagesBound.Insert(\{ slot, binding \}, image);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00088}00088 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00089}00089 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00090}\mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_adb7f2b5e8d92e77b8dc920c34442bc3b}{00090}} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_o_s_k_1_1_e_c_s_1_1_model_component3_d_adb7f2b5e8d92e77b8dc920c34442bc3b}{ModelComponent3D::BindUniformBufferForAllMeshes}}(\textcolor{keyword}{const} std::string\& slot, \textcolor{keyword}{const} std::string\& binding, \textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_uniform_buffer}{GRAPHICS::IGpuUniformBuffer}}* buffer) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00091}00091     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i : meshesMaterialInstances) \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00092}00092         i-\/>GetSlot(slot)-\/>SetUniformBuffer(binding, buffer);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00093}00093         i-\/>GetSlot(slot)-\/>FlushUpdate();}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00094}00094     \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00096}00096     uniformBuffersBound.Insert(\{ slot, binding \}, buffer);}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00097}00097 \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00099}\mbox{\hyperlink{structstd_1_1hash_3_01_o_s_k_1_1_pair_3_01std_1_1string_00_01std_1_1string_01_4_01_4}{00099}} \textcolor{keyword}{template} <> \textcolor{keyword}{struct }std::hash<\mbox{\hyperlink{namespace_o_s_k}{OSK}}::\mbox{\hyperlink{struct_o_s_k_1_1_pair}{Pair}}<std::string, std::string>> \{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00100}\mbox{\hyperlink{structstd_1_1hash_3_01_o_s_k_1_1_pair_3_01std_1_1string_00_01std_1_1string_01_4_01_4_a28976513eafe13f0ad3e5179ab8ebbe4}{00100}}     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{structstd_1_1hash_3_01_o_s_k_1_1_pair_3_01std_1_1string_00_01std_1_1string_01_4_01_4_a28976513eafe13f0ad3e5179ab8ebbe4}{operator()}}(\textcolor{keyword}{const} \mbox{\hyperlink{struct_o_s_k_1_1_pair}{Pair<std::string, std::string>}}\& x)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00101}00101 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00102}00102         \textcolor{keywordflow}{return} std::hash<std::string>()(x.\mbox{\hyperlink{struct_o_s_k_1_1_pair_a71b76e984cdf5577771558ea24493d72}{first}});}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00103}00103     \}}
\DoxyCodeLine{\Hypertarget{_model_component3_d_8cpp_source_l00104}00104 \};}

\end{DoxyCode}
