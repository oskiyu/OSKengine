\hypertarget{_pipeline_layout_dx12_8cpp_source}{}\doxysection{Pipeline\+Layout\+Dx12.\+cpp}
\label{_pipeline_layout_dx12_8cpp_source}\index{OSKengine2/PipelineLayoutDx12.cpp@{OSKengine2/PipelineLayoutDx12.cpp}}
\mbox{\hyperlink{_pipeline_layout_dx12_8cpp}{Ir a la documentaci√≥n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_pipeline_layout_dx12_8h}{PipelineLayoutDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_material_layout_8h}{MaterialLayout.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_shader_binding_type_8h}{ShaderBindingType.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_o_s_kengine_8h}{OSKengine.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_i_renderer_8h}{IRenderer.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00008}00008 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_dx12_8h}{GpuDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00009}00009 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_logger_8h}{Logger.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00011}00011 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k}{OSK}};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00012}00012 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s}{OSK::GRAPHICS}};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00014}\mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a5edb82d7cd125eedfba97467816e11c9}{00014}} D3D12\_SHADER\_VISIBILITY \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a5edb82d7cd125eedfba97467816e11c9}{GetShaderStageDx12}}(\mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_aa7e7dcffcab27051f141128e66a50fcb}{ShaderStage}} stage) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00015}00015     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_o_s_k_1_1_e_f_traits_a8b4d083d34df5ab4cc95043f91b5a24c}{OSK::EFTraits::HasFlag}}(stage, ShaderStage::VERTEX)}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00016}00016         \&\& \mbox{\hyperlink{namespace_o_s_k_1_1_e_f_traits_a8b4d083d34df5ab4cc95043f91b5a24c}{OSK::EFTraits::HasFlag}}(stage, ShaderStage::FRAGMENT))}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00017}00017         \textcolor{keywordflow}{return} D3D12\_SHADER\_VISIBILITY\_ALL;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00019}00019     \textcolor{keywordflow}{switch} (stage) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00020}00020     \textcolor{keywordflow}{case} ShaderStage::VERTEX:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00021}00021         \textcolor{keywordflow}{return} D3D12\_SHADER\_VISIBILITY\_VERTEX;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00022}00022     \textcolor{keywordflow}{case} ShaderStage::FRAGMENT:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00023}00023         \textcolor{keywordflow}{return} D3D12\_SHADER\_VISIBILITY\_PIXEL;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00024}00024     \textcolor{keywordflow}{case} ShaderStage::TESSELATION\_CONTROL:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00025}00025         \textcolor{keywordflow}{return} D3D12\_SHADER\_VISIBILITY\_ALL;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00026}00026     \textcolor{keywordflow}{case} ShaderStage::TESSELATION\_EVALUATION:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00027}00027         \textcolor{keywordflow}{return} D3D12\_SHADER\_VISIBILITY\_ALL;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00028}00028     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00029}00029         \textcolor{keywordflow}{return} D3D12\_SHADER\_VISIBILITY\_ALL;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00030}00030     \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00031}00031 \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00033}\mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a18fa8f41c74d3693233f60660ef0eb61}{00033}} D3D12\_ROOT\_PARAMETER\_TYPE \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a18fa8f41c74d3693233f60660ef0eb61}{GetParamTypeDx12}}(\mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a4a3cc5ac5a7f3c8753e7f74d576d6e1d}{ShaderBindingType}} type) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00034}00034     \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00035}00035     \textcolor{keywordflow}{case} ShaderBindingType::UNIFORM\_BUFFER:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00036}00036         \textcolor{keywordflow}{return} D3D12\_ROOT\_PARAMETER\_TYPE\_CBV;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00037}00037     \textcolor{keywordflow}{case} ShaderBindingType::STORAGE\_BUFFER:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00038}00038     \textcolor{keywordflow}{case} ShaderBindingType::STORAGE\_IMAGE:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00039}00039         \textcolor{keywordflow}{return} D3D12\_ROOT\_PARAMETER\_TYPE\_UAV;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00040}00040     \textcolor{keywordflow}{case} ShaderBindingType::TEXTURE:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00041}00041         \textcolor{comment}{//break;}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00042}00042     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00043}00043         \textcolor{keywordflow}{return} D3D12\_ROOT\_PARAMETER\_TYPE\_CBV;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00044}00044     \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00045}00045 \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00048}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_pipeline_layout_dx12_a3fd7ec2e8eb3534fd83ec384e4e1e5df}{00048}} PipelineLayoutDx12::PipelineLayoutDx12(\textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material_layout}{MaterialLayout}}* layout)}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00049}00049     : \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_pipeline_layout}{IPipelineLayout}}(layout) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00051}00051     \textcolor{comment}{// Owned.}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00052}00052     \mbox{\hyperlink{class_o_s_k_1_1_dynamic_array}{DynamicArray<UniquePtr<D3D12\_DESCRIPTOR\_RANGE>}}> descriptorRanges;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00053}00053     \textcolor{comment}{// Owned.}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00054}00054     \mbox{\hyperlink{class_o_s_k_1_1_dynamic_array}{DynamicArray<D3D12\_STATIC\_SAMPLER\_DESC>}} staticSamplers;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00056}00056     \mbox{\hyperlink{class_o_s_k_1_1_dynamic_array}{DynamicArray<D3D12\_ROOT\_PARAMETER>}} nativeParams;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00057}00057     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& setName : layout-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material_layout_a82de8efeace9ce18733634fb7c1cc8a3}{GetAllSlotNames}}()) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00058}00058         \textcolor{keyword}{auto}\& set = layout-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material_layout_a7a1845df7f0113a0285adfbea469df90}{GetSlot}}(setName);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00060}00060         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& [name, binding] : set.bindings) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00061}00061             \textcolor{keywordflow}{if} (binding.type == \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a4a3cc5ac5a7f3c8753e7f74d576d6e1da8d0be820da8f4fe5aa49e0ef3065ca29}{ShaderBindingType::UNIFORM\_BUFFER}}) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00062}00062                 D3D12\_ROOT\_PARAMETER param\{\};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00063}00063                 param.ShaderVisibility = \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a5edb82d7cd125eedfba97467816e11c9}{GetShaderStageDx12}}(set.stage);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00064}00064                 param.ParameterType = \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a18fa8f41c74d3693233f60660ef0eb61}{GetParamTypeDx12}}(binding.type);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00065}00065                 param.Descriptor.RegisterSpace = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00066}00066                 param.Descriptor.ShaderRegister = binding.hlslIndex;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00068}00068                 nativeParams.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a2c1e7bd2efbadf8b163f67c26921ba53}{Insert}}(param);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00069}00069             \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00070}00070             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (binding.type == \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a4a3cc5ac5a7f3c8753e7f74d576d6e1da3f92f542bd9ec48f912b9350e22736ac}{ShaderBindingType::TEXTURE}}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00071}00071                     || binding.type == \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a4a3cc5ac5a7f3c8753e7f74d576d6e1daf28b30e806ea29c1d6011d1feeea8913}{ShaderBindingType::CUBEMAP}}) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00072}00072                 \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<D3D12\_DESCRIPTOR\_RANGE>}} textureDescriptorRange = \textcolor{keyword}{new} D3D12\_DESCRIPTOR\_RANGE(\{\});}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00073}00073                 textureDescriptorRange[0].BaseShaderRegister = binding.hlslIndex;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00074}00074                 textureDescriptorRange[0].NumDescriptors = 1;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00075}00075                 textureDescriptorRange[0].OffsetInDescriptorsFromTableStart = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00076}00076                 textureDescriptorRange[0].RangeType = D3D12\_DESCRIPTOR\_RANGE\_TYPE\_SRV;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00077}00077                 textureDescriptorRange[0].RegisterSpace = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00079}00079                 D3D12\_STATIC\_SAMPLER\_DESC sampler\{\};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00080}00080                 sampler.RegisterSpace = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00081}00081                 sampler.ShaderRegister = binding.hlslIndex;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00082}00082                 sampler.ShaderVisibility = \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a5edb82d7cd125eedfba97467816e11c9}{GetShaderStageDx12}}(set.stage);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00084}00084                 sampler.Filter = D3D12\_FILTER\_MIN\_MAG\_MIP\_LINEAR;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00085}00085                 sampler.AddressU = D3D12\_TEXTURE\_ADDRESS\_MODE\_MIRROR;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00086}00086                 sampler.AddressV = D3D12\_TEXTURE\_ADDRESS\_MODE\_MIRROR;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00087}00087                 sampler.AddressW = D3D12\_TEXTURE\_ADDRESS\_MODE\_MIRROR;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00088}00088                 sampler.MipLODBias = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00089}00089                 sampler.MaxAnisotropy = 16;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00090}00090                 sampler.ComparisonFunc = D3D12\_COMPARISON\_FUNC\_NEVER;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00091}00091                 sampler.BorderColor = D3D12\_STATIC\_BORDER\_COLOR\_OPAQUE\_BLACK;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00092}00092                 sampler.MinLOD = 0.0f;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00093}00093                 sampler.MaxLOD = D3D12\_FLOAT32\_MAX;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00095}00095                 D3D12\_ROOT\_PARAMETER param\{\};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00096}00096                 param.ShaderVisibility = \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a5edb82d7cd125eedfba97467816e11c9}{GetShaderStageDx12}}(set.stage);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00097}00097                 param.ParameterType = D3D12\_ROOT\_PARAMETER\_TYPE\_DESCRIPTOR\_TABLE;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00098}00098                 param.DescriptorTable.NumDescriptorRanges = 1;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00099}00099                 param.DescriptorTable.pDescriptorRanges = textureDescriptorRange.\mbox{\hyperlink{class_o_s_k_1_1_owned_ptr_a81dfab2299056fc9858aace55fca0042}{GetPointer}}();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00101}00101                 descriptorRanges.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a2c1e7bd2efbadf8b163f67c26921ba53}{Insert}}(textureDescriptorRange.\mbox{\hyperlink{class_o_s_k_1_1_owned_ptr_a81dfab2299056fc9858aace55fca0042}{GetPointer}}());}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00102}00102                 staticSamplers.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a2c1e7bd2efbadf8b163f67c26921ba53}{Insert}}(sampler);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00103}00103 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00104}00104                 nativeParams.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a2c1e7bd2efbadf8b163f67c26921ba53}{Insert}}(param);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00105}00105             \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00106}00106             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (binding.type == \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a4a3cc5ac5a7f3c8753e7f74d576d6e1daa486db75420308f63af20d85e2b6489d}{ShaderBindingType::STORAGE\_BUFFER}}) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00107}00107                 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00108}00108             \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00109}00109             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(binding.type == \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a4a3cc5ac5a7f3c8753e7f74d576d6e1da17a99bfdcbe59e8209f17c4da5de6ff9}{ShaderBindingType::STORAGE\_IMAGE}}) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00110}00110                 \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<D3D12\_DESCRIPTOR\_RANGE>}} textureDescriptorRange = \textcolor{keyword}{new} D3D12\_DESCRIPTOR\_RANGE(\{\});}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00111}00111                 textureDescriptorRange[0].BaseShaderRegister = binding.hlslDescriptorIndex;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00112}00112                 textureDescriptorRange[0].NumDescriptors = 1;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00113}00113                 textureDescriptorRange[0].OffsetInDescriptorsFromTableStart = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00114}00114                 textureDescriptorRange[0].RangeType = D3D12\_DESCRIPTOR\_RANGE\_TYPE\_UAV;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00115}00115                 textureDescriptorRange[0].RegisterSpace = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00116}00116 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00117}00117                 D3D12\_UNORDERED\_ACCESS\_VIEW\_DESC desc\{\};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00118}00118                 desc.ViewDimension = D3D12\_UAV\_DIMENSION\_TEXTURE2D;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00119}00119                 desc.Texture2D.PlaneSlice = 0; \textcolor{comment}{// @todo}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00120}00120                 desc.Texture2D.MipSlice = 0;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00121}00121 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00122}00122                 D3D12\_ROOT\_PARAMETER param\{\};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00123}00123                 param.ShaderVisibility = \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a5edb82d7cd125eedfba97467816e11c9}{GetShaderStageDx12}}(set.stage);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00124}00124                 param.ParameterType = D3D12\_ROOT\_PARAMETER\_TYPE\_DESCRIPTOR\_TABLE;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00125}00125                 param.DescriptorTable.NumDescriptorRanges = 1;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00126}00126                 param.DescriptorTable.pDescriptorRanges = textureDescriptorRange.\mbox{\hyperlink{class_o_s_k_1_1_owned_ptr_a81dfab2299056fc9858aace55fca0042}{GetPointer}}();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00128}00128                 descriptorRanges.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a2c1e7bd2efbadf8b163f67c26921ba53}{Insert}}(textureDescriptorRange.\mbox{\hyperlink{class_o_s_k_1_1_owned_ptr_a81dfab2299056fc9858aace55fca0042}{GetPointer}}());}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00130}00130                 nativeParams.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a2c1e7bd2efbadf8b163f67c26921ba53}{Insert}}(param);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00131}00131             \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00132}00132         \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00133}00133     \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00134}00134 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00135}00135     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& pConst : layout-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_material_layout_aeb38d6651a3696756da72767b802913a}{GetAllPushConstants}}()) \{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00136}00136         D3D12\_ROOT\_PARAMETER param\{\};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00137}00137         param.ShaderVisibility = \mbox{\hyperlink{_pipeline_layout_dx12_8cpp_a5edb82d7cd125eedfba97467816e11c9}{GetShaderStageDx12}}(pConst.second.stage);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00138}00138         param.ParameterType = D3D12\_ROOT\_PARAMETER\_TYPE\_32BIT\_CONSTANTS;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00139}00139         param.Constants.RegisterSpace = 1;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00140}00140         param.Constants.ShaderRegister = pConst.second.hlslIndex;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00141}00141         param.Constants.Num32BitValues = pConst.second.size / 4;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00143}00143         nativeParams.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a2c1e7bd2efbadf8b163f67c26921ba53}{Insert}}(param);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00144}00144     \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00146}00146     D3D12\_ROOT\_SIGNATURE\_DESC description\{\};}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00147}00147     description.Flags = D3D12\_ROOT\_SIGNATURE\_FLAG\_ALLOW\_INPUT\_ASSEMBLER\_INPUT\_LAYOUT;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00148}00148     description.NumParameters = nativeParams.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a94d0cbf0543d0c976de674d31b15df90}{GetSize}}();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00149}00149     description.pParameters = nativeParams.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_ac8a6d70f938c482e1f7aa68c7d186bb8}{GetData}}();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00150}00150     description.NumStaticSamplers = staticSamplers.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a94d0cbf0543d0c976de674d31b15df90}{GetSize}}();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00151}00151     description.pStaticSamplers = staticSamplers.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_ac8a6d70f938c482e1f7aa68c7d186bb8}{GetData}}();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00153}00153     ComPtr<ID3DBlob> error;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00154}00154     ComPtr<ID3DBlob> sign;}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00156}00156     \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_dx12}{GpuDx12}}* gpu = \mbox{\hyperlink{class_o_s_k_1_1_engine_a019c5397d042224c134b7fd22c739d00}{Engine::GetRenderer}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_renderer_a8b6b1698afeb3bb07f3b91e5ddb79b2d}{GetGpu}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_a1b0e5d22fed49696034d38442892121c}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_dx12}{GpuDx12}}>();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00158}00158     \textcolor{keyword}{const} HRESULT result = D3D12SerializeRootSignature(\&description, D3D\_ROOT\_SIGNATURE\_VERSION\_1\_0, \&sign, \&error);}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00159}00159     gpu-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_dx12_ab84e92317bb196210a9a4193763d5329}{GetDevice}}()-\/>CreateRootSignature(0, sign-\/>GetBufferPointer(), sign-\/>GetBufferSize(), IID\_PPV\_ARGS(\&signature));}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00160}00160 \}}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00162}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_pipeline_layout_dx12_a97ab9e5afdc21c0a446f7f72bad8c1a7}{00162}} ID3D12RootSignature* \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_pipeline_layout_dx12_a97ab9e5afdc21c0a446f7f72bad8c1a7}{PipelineLayoutDx12::GetSignature}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00163}00163     \textcolor{keywordflow}{return} signature.Get();}
\DoxyCodeLine{\Hypertarget{_pipeline_layout_dx12_8cpp_source_l00164}00164 \}}

\end{DoxyCode}
