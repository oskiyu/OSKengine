\hypertarget{_gpu_memory_allocator_dx12_8cpp_source}{}\doxysection{Gpu\+Memory\+Allocator\+Dx12.\+cpp}
\label{_gpu_memory_allocator_dx12_8cpp_source}\index{OSKengine2/GpuMemoryAllocatorDx12.cpp@{OSKengine2/GpuMemoryAllocatorDx12.cpp}}
\mbox{\hyperlink{_gpu_memory_allocator_dx12_8cpp}{Ir a la documentaci√≥n de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_memory_allocator_dx12_8h}{GpuMemoryAllocatorDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00003}00003 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_memory_block_dx12_8h}{GpuMemoryBlockDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00004}00004 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_memory_subblock_dx12_8h}{GpuMemorySubblockDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00005}00005 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_image_dx12_8h}{GpuImageDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00006}00006 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_vertex_buffer_dx12_8h}{GpuVertexBufferDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00007}00007 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_dx12_8h}{GpuDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00008}00008 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_memory_types_dx12_8h}{GpuMemoryTypesDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00009}00009 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_vertex_8h}{Vertex.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00010}00010 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_memory_types_8h}{GpuMemoryTypes.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00011}00011 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_o_s_kengine_8h}{OSKengine.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00012}00012 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_renderer_dx12_8h}{RendererDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00013}00013 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_command_list_dx12_8h}{CommandListDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00014}00014 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_index_buffer_dx12_8h}{GpuIndexBufferDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00015}00015 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_uniform_buffer_dx12_8h}{GpuUniformBufferDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00016}00016 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_image_usage_8h}{GpuImageUsage.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00017}00017 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_format_dx12_8h}{FormatDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00018}00018 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_image_dimensions_8h}{GpuImageDimensions.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00019}00019 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_math_8h}{Math.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00020}00020 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_gpu_storage_buffer_dx12_8h}{GpuStorageBufferDx12.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00022}00022 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k}{OSK}};}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00023}00023 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s}{OSK::GRAPHICS}};}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00025}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_aa786af46ac462b8a9249f8592c3124f7}{00025}} GpuMemoryAllocatorDx12::GpuMemoryAllocatorDx12(\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu}{IGpu}}* device)}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00026}00026     : \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator}{IGpuMemoryAllocator}}(device) \{ }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00027}00027     }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00028}00028 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00030}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a82cfd7196603071a5a8b8040b6d44ab1}{00030}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IGpuMemoryBlock>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a82cfd7196603071a5a8b8040b6d44ab1}{GpuMemoryAllocatorDx12::CreateNewBufferBlock}}(\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} size, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7f}{GpuBufferUsage}} usage, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042ce}{GpuSharedMemoryType}} sharedType) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00031}00031     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_block_dx12_a6e95ea54b078e71df2642158eb31d01c}{GpuMemoryBlockDx12::CreateNewBufferBlock}}(size, \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a8f655b1e1884b8285b6d90b3d8f94e98}{device}}, sharedType, usage).GetPointer();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00032}00032 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00034}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ad1498ab79f352797847e9547f422dac7}{00034}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IGpuMemoryBlock>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ad1498ab79f352797847e9547f422dac7}{GpuMemoryAllocatorDx12::CreateNewImageBlock}}(\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_image}{GpuImage}}* image, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a19a2f70fc994c00eb022e520608c5ffa}{GpuImageUsage}} usage, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042ce}{GpuSharedMemoryType}} sharedType) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00035}00035     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_block_dx12_a3b169902dd5b23548da5d10c349a53db}{GpuMemoryBlockDx12::CreateNewImageBlock}}(image, \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a8f655b1e1884b8285b6d90b3d8f94e98}{device}}, sharedType, usage, image-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_image_a3f6e78b29f06b1b423ab89377a139b46}{GetNumLayers}}()).GetPointer();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00036}00036 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00038}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ac094fa6afa1e9ec4d9e099229d574350}{00038}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<GpuDataBuffer>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ac094fa6afa1e9ec4d9e099229d574350}{GpuMemoryAllocatorDx12::CreateStagingBuffer}}(\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} size) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00039}00039     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer}{GpuDataBuffer}}(\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a688b3d07de2ec4181441bb0c220aaa49}{GetNextBufferMemoryBlock}}(size, }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00040}00040         \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7fafb3bb8503e5cd907a3a7b02a495c229e}{GpuBufferUsage::TRANSFER\_SOURCE}}, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042cea096f8c31942629a91cc086cbda5f5465}{GpuSharedMemoryType::GPU\_AND\_CPU}})-\/>GetNextMemorySubblock(size, D3D12\_DEFAULT\_RESOURCE\_PLACEMENT\_ALIGNMENT), size, 0);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00041}00041 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00043}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a905e6e7e678e2d8112c9f830cebf3448}{00043}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IGpuVertexBuffer>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a905e6e7e678e2d8112c9f830cebf3448}{GpuMemoryAllocatorDx12::CreateVertexBuffer}}(\textcolor{keyword}{const} \textcolor{keywordtype}{void}* data, \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} vertexSize, \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} numVertices, \textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_vertex_info}{VertexInfo}}\& vertexInfo) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00044}00044     \textcolor{keyword}{const} \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} bufferSize = numVertices * vertexSize;}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00045}00045     \textcolor{keyword}{auto} block = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a688b3d07de2ec4181441bb0c220aaa49}{GetNextBufferMemoryBlock}}(bufferSize, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7faa77fcc0c8db7e3e4c3ca370997298c34}{GpuBufferUsage::VERTEX\_BUFFER}}, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042cea95c8166e4f408834884bbe57fef928f6}{GpuSharedMemoryType::GPU\_ONLY}});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00047}00047     \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer}{GpuDataBuffer}}* stagingBuffer = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ac094fa6afa1e9ec4d9e099229d574350}{CreateStagingBuffer}}(bufferSize).GetPointer();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00048}00048     stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a794d4d1ba8f5f2e81288398e59894eb9}{MapMemory}}();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00049}00049     stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_aadfb37dc25b557c76dc43a3de3667d18}{Write}}(data, bufferSize);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00050}00050     stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_ae807883f0c19342039d54ba88d45e968}{Unmap}}();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00052}00052     \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_vertex_buffer_dx12}{GpuVertexBufferDx12}}* output = \textcolor{keyword}{new} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_vertex_buffer_dx12}{GpuVertexBufferDx12}}(block-\/>GetNextMemorySubblock(bufferSize, D3D12\_DEFAULT\_RESOURCE\_PLACEMENT\_ALIGNMENT), bufferSize, 0, numVertices, vertexInfo);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00054}00054     \textcolor{keyword}{auto} singleTimeCommandList = \mbox{\hyperlink{class_o_s_k_1_1_engine_a019c5397d042224c134b7fd22c739d00}{Engine::GetRenderer}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_renderer_a0fa1cd26067c520e90cfa647f66e8366}{CreateSingleUseCommandList}}()-\/>As<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_command_list_dx12}{CommandListDx12}}>();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00055}00055     singleTimeCommandList-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_command_list_dx12_a759a7b5bafbc49c807e324cf7f21df4b}{Reset}}();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00056}00056     singleTimeCommandList-\/>Start();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00057}00057     }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00058}00058     singleTimeCommandList-\/>ResourceBarrier(}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00059}00059         output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource(),}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00060}00060         D3D12\_RESOURCE\_STATE\_GENERIC\_READ,}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00061}00061         D3D12\_RESOURCE\_STATE\_COPY\_DEST);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00063}00063     singleTimeCommandList-\/>GetCommandList()-\/>CopyResource(}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00064}00064         output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource(),}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00065}00065         stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource());}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00067}00067     singleTimeCommandList-\/>ResourceBarrier(}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00068}00068         output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource(),}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00069}00069         D3D12\_RESOURCE\_STATE\_COPY\_DEST,}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00070}00070         D3D12\_RESOURCE\_STATE\_VERTEX\_AND\_CONSTANT\_BUFFER);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00072}00072     singleTimeCommandList-\/>Close();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00074}00074     \mbox{\hyperlink{class_o_s_k_1_1_engine_a019c5397d042224c134b7fd22c739d00}{Engine::GetRenderer}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_renderer_af337a6b45b1e298a4edff91981586d14}{SubmitSingleUseCommandList}}(singleTimeCommandList);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00076}00076     singleTimeCommandList-\/>RegisterStagingBuffer(stagingBuffer);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00078}00078     output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_vertex_buffer_dx12_ad135b2c5562834cebf58565153cbdcd9}{SetView}}(vertexSize, numVertices);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00079}00079 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00080}00080     \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00081}00081 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00082}00082 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00083}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a9958398421f6574af4c8010899dae040}{00083}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IGpuIndexBuffer>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a9958398421f6574af4c8010899dae040}{GpuMemoryAllocatorDx12::CreateIndexBuffer}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_dynamic_array}{DynamicArray<TIndexSize>}}\& indices) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00084}00084     \textcolor{keyword}{const} \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} bufferSize = \textcolor{keyword}{sizeof}(\mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a05f5134cdcc67a7889c57e39aa2f25ae}{TIndexSize}}) * indices.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a94d0cbf0543d0c976de674d31b15df90}{GetSize}}();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00085}00085     \textcolor{keyword}{auto} block = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a688b3d07de2ec4181441bb0c220aaa49}{GetNextBufferMemoryBlock}}(bufferSize, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7fa24ba47a6b7ca772e4185e7a7b54d4c90}{GpuBufferUsage::INDEX\_BUFFER}}, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042cea95c8166e4f408834884bbe57fef928f6}{GpuSharedMemoryType::GPU\_ONLY}});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00087}00087     \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer}{GpuDataBuffer}}* stagingBuffer = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ac094fa6afa1e9ec4d9e099229d574350}{CreateStagingBuffer}}(bufferSize).GetPointer();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00088}00088     stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a794d4d1ba8f5f2e81288398e59894eb9}{MapMemory}}();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00089}00089     stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_aadfb37dc25b557c76dc43a3de3667d18}{Write}}(indices.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_ac8a6d70f938c482e1f7aa68c7d186bb8}{GetData}}(), bufferSize);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00090}00090     stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_ae807883f0c19342039d54ba88d45e968}{Unmap}}();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00092}00092     \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_index_buffer_dx12}{GpuIndexBufferDx12}}* output = \textcolor{keyword}{new} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_index_buffer_dx12}{GpuIndexBufferDx12}}(block-\/>GetNextMemorySubblock(bufferSize, D3D12\_DEFAULT\_RESOURCE\_PLACEMENT\_ALIGNMENT), bufferSize, 0, indices.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a94d0cbf0543d0c976de674d31b15df90}{GetSize}}());}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00094}00094     \textcolor{keyword}{auto} singleTimeCommandList = \mbox{\hyperlink{class_o_s_k_1_1_engine_a019c5397d042224c134b7fd22c739d00}{Engine::GetRenderer}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_renderer_a0fa1cd26067c520e90cfa647f66e8366}{CreateSingleUseCommandList}}()-\/>As<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_command_list_dx12}{CommandListDx12}}>();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00095}00095     singleTimeCommandList-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_command_list_dx12_a759a7b5bafbc49c807e324cf7f21df4b}{Reset}}();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00096}00096     singleTimeCommandList-\/>Start();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00098}00098     singleTimeCommandList-\/>ResourceBarrier(}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00099}00099         output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource(),}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00100}00100         D3D12\_RESOURCE\_STATE\_GENERIC\_READ,}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00101}00101         D3D12\_RESOURCE\_STATE\_COPY\_DEST);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00103}00103     singleTimeCommandList-\/>GetCommandList()-\/>CopyResource(}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00104}00104         output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource(),}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00105}00105         stagingBuffer-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource());}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00107}00107     singleTimeCommandList-\/>ResourceBarrier(}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00108}00108         output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_data_buffer_a0e688b372c65d28e21d562528355a08d}{GetMemorySubblock}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_subblock_a184a8433d5967eea3dd00fd988d3dff2}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_subblock_dx12}{GpuMemorySubblockDx12}}>()-\/>GetResource(),}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00109}00109         D3D12\_RESOURCE\_STATE\_COPY\_DEST,}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00110}00110         D3D12\_RESOURCE\_STATE\_INDEX\_BUFFER);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00112}00112     singleTimeCommandList-\/>Close();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00114}00114     \mbox{\hyperlink{class_o_s_k_1_1_engine_a019c5397d042224c134b7fd22c739d00}{Engine::GetRenderer}}()-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_renderer_af337a6b45b1e298a4edff91981586d14}{SubmitSingleUseCommandList}}(singleTimeCommandList);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00116}00116     singleTimeCommandList-\/>RegisterStagingBuffer(stagingBuffer);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00118}00118     output-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_index_buffer_dx12_a9f801d97a5f84200805f2ea99a93b8a6}{SetView}}(indices.\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array_a94d0cbf0543d0c976de674d31b15df90}{GetSize}}());}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00119}00119 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00120}00120     \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00121}00121 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00122}00122 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00123}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a3af5fa17cdbe30e7ed249dec9b4bdaf0}{00123}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IGpuUniformBuffer>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a3af5fa17cdbe30e7ed249dec9b4bdaf0}{GpuMemoryAllocatorDx12::CreateUniformBuffer}}(\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} size) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00124}00124     \textcolor{keyword}{auto} block = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a688b3d07de2ec4181441bb0c220aaa49}{GetNextBufferMemoryBlock}}(size, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7fa8d0be820da8f4fe5aa49e0ef3065ca29}{GpuBufferUsage::UNIFORM\_BUFFER}}, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042cea096f8c31942629a91cc086cbda5f5465}{GpuSharedMemoryType::GPU\_AND\_CPU}});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00125}00125 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00126}00126     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_uniform_buffer_dx12}{GpuUniformBufferDx12}}(block-\/>GetNextMemorySubblock(size, D3D12\_DEFAULT\_RESOURCE\_PLACEMENT\_ALIGNMENT), size, 0);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00127}00127 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00129}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_acf8413caf2c7dcdd54d01a533b8ca2f2}{00129}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IGpuStorageBuffer>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_acf8413caf2c7dcdd54d01a533b8ca2f2}{OSK::GRAPHICS::GpuMemoryAllocatorDx12::CreateStorageBuffer}}(\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} size) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00130}00130     \textcolor{keyword}{auto} block = GetNextBufferMemoryBlock(size, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7faa486db75420308f63af20d85e2b6489d}{GpuBufferUsage::STORAGE\_BUFFER}}, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042cea096f8c31942629a91cc086cbda5f5465}{GpuSharedMemoryType::GPU\_AND\_CPU}});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00132}00132     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_storage_buffer_dx12}{GpuStorageBufferDx12}}(block-\/>GetNextMemorySubblock(size, D3D12\_DEFAULT\_RESOURCE\_PLACEMENT\_ALIGNMENT), size, 0);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00133}00133 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00134}00134 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00135}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ac45631c638647ca85f056105c856153d}{00135}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<GpuImage>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_ac45631c638647ca85f056105c856153d}{GpuMemoryAllocatorDx12::CreateImage}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_vector3__t}{Vector3ui}}\& size, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ab91ccc08d13454cfeb3c4f78deb72d59}{GpuImageDimension}} dimension, \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} numLayers, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_aac59f9d056e083c0b49ea768f974e3e8}{Format}} format, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a19a2f70fc994c00eb022e520608c5ffa}{GpuImageUsage}} usage, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042ce}{GpuSharedMemoryType}} sharedType, \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} msaaSamples, \mbox{\hyperlink{struct_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_image_sampler_desc}{GpuImageSamplerDesc}} samplerDesc) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00136}00136     \textcolor{keyword}{auto} output = \textcolor{keyword}{new} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_image_dx12}{GpuImageDx12}}(size, dimension, usage, numLayers, format, msaaSamples, samplerDesc);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00137}00137     output-\/>\_SetPhysicalSize(\{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00138}00138         MATH::PrimerMultiploSuperior<uint32\_t>(size.\mbox{\hyperlink{class_o_s_k_1_1_vector3__t_a9dd92e8b519b62ce53eb71f58eba6d50}{X}}, D3D12\_TEXTURE\_DATA\_PITCH\_ALIGNMENT),}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00139}00139         size.\mbox{\hyperlink{class_o_s_k_1_1_vector3__t_afb19e7227d4047f7a666c03cea2b1658}{Y}},}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00140}00140         size.\mbox{\hyperlink{class_o_s_k_1_1_vector3__t_a50505b9a44529ae5aff66a956214549b}{Z}}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00141}00141         \});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00143}00143     \textcolor{keyword}{auto} block = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_block_dx12_a3b169902dd5b23548da5d10c349a53db}{GpuMemoryBlockDx12::CreateNewImageBlock}}(output, \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a8f655b1e1884b8285b6d90b3d8f94e98}{device}}, sharedType, usage, numLayers);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00145}00145     output-\/>SetBlock(block.GetPointer());}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00147}00147     \textcolor{keywordflow}{return} output;}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00148}00148 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00151}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a7d3d38d431b4ba39ad83577bce318c5d}{00151}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IGpuMemoryBlock>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a7d3d38d431b4ba39ad83577bce318c5d}{GpuMemoryAllocatorDx12::CreateNewBufferMemoryBlock}}(\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} size, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7f}{GpuBufferUsage}} usage, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042ce}{GpuSharedMemoryType}} sharedType) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00152}00152     \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} bSize = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_ad3bb71a59933368693da358e40fd9cff}{IGpuMemoryAllocator::SizeOfMemoryBlockInMb}} * 1000;}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00154}00154     \textcolor{keywordflow}{if} (size > bSize)}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00155}00155         bSize = size;}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00156}00156 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00157}00157     \textcolor{keywordflow}{return} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_block_dx12_a6e95ea54b078e71df2642158eb31d01c}{GpuMemoryBlockDx12::CreateNewBufferBlock}}(bSize, \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a8f655b1e1884b8285b6d90b3d8f94e98}{device}}, sharedType, usage).GetPointer();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00158}00158 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00160}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_af246ce5741e7f0ef0a78f2fecc2fb251}{00160}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<GpuDataBuffer>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_af246ce5741e7f0ef0a78f2fecc2fb251}{GpuMemoryAllocatorDx12::CreateBuffer}}(\mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} size, \mbox{\hyperlink{_o_s_kmacros_8h_a1acaf9dff8b00604e55d38b35a744a9a}{TSize}} alignment, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_ad8b871b506bab7c4021326a1a10bbc7f}{GpuBufferUsage}} usage, \mbox{\hyperlink{namespace_o_s_k_1_1_g_r_a_p_h_i_c_s_a85a830e82585f3a565d1f097491042ce}{GpuSharedMemoryType}} sharedType) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00161}00161     \mbox{\hyperlink{_assert_8h_adfbccaec84df99b8277f9d877554170c}{OSK\_ASSERT}}(\textcolor{keyword}{false}, \textcolor{stringliteral}{"{}No implementado."{}});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00163}00163     \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00164}00164 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00166}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a55a581394f466346223a01aa3c9242a2}{00166}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<IBottomLevelAccelerationStructure>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a55a581394f466346223a01aa3c9242a2}{GpuMemoryAllocatorDx12::CreateBottomAccelerationStructure}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_vertex_buffer}{IGpuVertexBuffer}}\& vertexBuffer, \textcolor{keyword}{const} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_index_buffer}{IGpuIndexBuffer}}\& indexBuffer) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00167}00167     \mbox{\hyperlink{_assert_8h_adfbccaec84df99b8277f9d877554170c}{OSK\_ASSERT}}(\textcolor{keyword}{false}, \textcolor{stringliteral}{"{}No implementado."{}});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00169}00169     \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00170}00170 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00172}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a9a79bebe916ca78fcb3ccc734d5e59aa}{00172}} \mbox{\hyperlink{class_o_s_k_1_1_owned_ptr}{OwnedPtr<ITopLevelAccelerationStructure>}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a9a79bebe916ca78fcb3ccc734d5e59aa}{GpuMemoryAllocatorDx12::CreateTopAccelerationStructure}}(\mbox{\hyperlink{class_o_s_k_1_1_dynamic_array}{DynamicArray<const IBottomLevelAccelerationStructure*>}} bottomStructures) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00173}00173     \mbox{\hyperlink{_assert_8h_adfbccaec84df99b8277f9d877554170c}{OSK\_ASSERT}}(\textcolor{keyword}{false}, \textcolor{stringliteral}{"{}No implementado."{}});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00175}00175     \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00176}00176 \}}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00178}\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a6e6ca51985913b36e836dbaa552079b3}{00178}} \mbox{\hyperlink{struct_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_descriptor_dx12}{DescriptorDx12}} \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_a6e6ca51985913b36e836dbaa552079b3}{GpuMemoryAllocatorDx12::GetDescriptor}}(D3D12\_DESCRIPTOR\_HEAP\_TYPE type) \{}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00179}00179     \textcolor{keyword}{const} \textcolor{keyword}{auto} itertator = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_aea7ebb41550d7df62c8f796bb36962f4}{descriptorBlocks}}.Find(type);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00180}00180 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00181}00181     \textcolor{keywordflow}{if} (itertator.IsEmpty())}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00182}00182         \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_aea7ebb41550d7df62c8f796bb36962f4}{descriptorBlocks}}.Insert(type, \{\});}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00183}00183 }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00184}00184     \textcolor{keyword}{auto}\& list = \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_memory_allocator_dx12_aea7ebb41550d7df62c8f796bb36962f4}{descriptorBlocks}}.Get(type);}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00185}00185     \textcolor{keywordflow}{if} (list.IsEmpty() || list.Peek().IsFull())}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00186}00186         list.Insert(\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_descriptor_block_dx12}{DescriptorBlockDx12}}(type, 256, \mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_memory_allocator_a8f655b1e1884b8285b6d90b3d8f94e98}{device}}-\/>\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_i_gpu_a1b0e5d22fed49696034d38442892121c}{As}}<\mbox{\hyperlink{class_o_s_k_1_1_g_r_a_p_h_i_c_s_1_1_gpu_dx12}{GpuDx12}}>()));}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00187}00187         }
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00188}00188     \textcolor{keywordflow}{return} list.Peek().CreateDescriptor();}
\DoxyCodeLine{\Hypertarget{_gpu_memory_allocator_dx12_8cpp_source_l00189}00189 \}}

\end{DoxyCode}
